##
# by Kirin (1370302499@qq.com)
# version 0.5
#
# Copyright (c) 2020 Kirin
##


##### customizable part #####

TARGET := trie
COMPILER := g++
FLAGS := -std=c++17 -O2 -w
BUILD := build
INCLUDE := include
SOURCE := source


##### auto-generated part #####

export

ifeq ($(OS),Windows_NT)
	EXE := .exe
	RM := del
endif

includes := $(wildcard $(INCLUDE)/*.hpp $(INCLUDE)/*.h)
sources := $(wildcard $(SOURCE)/*.cpp)
dependencies := $(sources:$(SOURCE)/%.cpp=$(BUILD)/%.d)
objects := $(patsubst %.d,%.o,$(dependencies))
executable := $(TARGET)$(EXE)
cleanable := $(executable)
ifeq ($(OS),Windows_NT)
	cleanable += $(subst /,\\,$(dependencies)) $(subst /,\\,$(objects))
else
	cleanable += $(dependencies) $(objects)
endif

$(executable): FORCE
	$(MAKE) -j -f detail.mk $@

build: $(executable)
clean:
	@echo [33mCleaning the target and all the object files  ...[0m
	$(RM) $(cleanable)
rebuild: clean build
run: $(executable)
	./$(executable)
info:
	@echo [sinclude files:[u[20C$(notdir $(includes))
	@echo [ssource files:[u[20C$(notdir $(sources))
	@echo [sobject files:[u[20C$(notdir $(objects))
	@echo [sdependency files:[u[20C$(notdir $(dependencies))
	@echo [starget:[u[20C$(TARGET)
help:
	@echo Usage:  $(MAKE) [option]
	@echo Options:
		@echo [s[4Cbuild[u[20CGenerate the target.
			@echo [20CThis is the default when [option] is empty.
		@echo [s[4Cclean[u[20CClean all the files generated by this makefile.
		@echo [s[4Crebuild[u[20CRecompile all the source files and regenerate the target.
			@echo [20CSame as [clean] and then [build].
		@echo [s[4Crun[u[20CExecute the target.
			@echo [20CIt will [build] first if the target is not found or outdated.
		@echo [s[4Cinfo[u[20CDisplay the information related to this makefile.
		@echo [s[4Chelp[u[20CShow this help message.

FORCE:
.PHONY: build clean rebuild run info help FORCE
